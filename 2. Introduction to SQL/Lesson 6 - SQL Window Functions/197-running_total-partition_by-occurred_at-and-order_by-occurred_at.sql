/*
Programming for Data Science with Python Nanodegree
Udacity's certified program > SQL practice > Lesson 6 : SQL Window Functions

WINDOW FUNCTIONS:

Running total of standard_qty 'PARTITION BY' occurred_at and
'ORDER BY' occurred_at
*/

SELECT DATE_TRUNC('month', occurred_at),
       standard_qty,
       SUM(standard_qty) OVER (PARTITION BY DATE_TRUNC('month', occurred_at) ORDER BY occurred_at) AS running_total
FROM orders;

/*
Output6912 results

date_trunc	       standard_qty	running_total
2013-12-01T00:00:00.000Z	0	0
2013-12-01T00:00:00.000Z	490	490
2013-12-01T00:00:00.000Z	528	1018
2013-12-01T00:00:00.000Z	0	1018
2013-12-01T00:00:00.000Z	492	1510
2013-12-01T00:00:00.000Z	502	2012
2013-12-01T00:00:00.000Z	53	2065
2013-12-01T00:00:00.000Z	308	2373
2013-12-01T00:00:00.000Z	75	2448
2013-12-01T00:00:00.000Z	281	2729
2013-12-01T00:00:00.000Z	12	2741
2013-12-01T00:00:00.000Z	461	3202
2013-12-01T00:00:00.000Z	490	3692
2013-12-01T00:00:00.000Z	43	3735
2013-12-01T00:00:00.000Z	85	3820
2013-12-01T00:00:00.000Z	477	4297
2013-12-01T00:00:00.000Z	1780	6077
2013-12-01T00:00:00.000Z	501	6578
2013-12-01T00:00:00.000Z	0	6578
2013-12-01T00:00:00.000Z	501	7079
2013-12-01T00:00:00.000Z	481	7560
2013-12-01T00:00:00.000Z	0	7560
2013-12-01T00:00:00.000Z	491	8051
2013-12-01T00:00:00.000Z	0	8051
2013-12-01T00:00:00.000Z	501	8552
2013-12-01T00:00:00.000Z	0	8552
2013-12-01T00:00:00.000Z	639	9191
2013-12-01T00:00:00.000Z	310	9501
2013-12-01T00:00:00.000Z	217	9718
2013-12-01T00:00:00.000Z	142	9860
2013-12-01T00:00:00.000Z	311	10171
2013-12-01T00:00:00.000Z	86	10257
2013-12-01T00:00:00.000Z	484	10741
2013-12-01T00:00:00.000Z	148	10889
2013-12-01T00:00:00.000Z	95	10984
2013-12-01T00:00:00.000Z	514	11498
2013-12-01T00:00:00.000Z	38	11536
2013-12-01T00:00:00.000Z	299	11835
2013-12-01T00:00:00.000Z	150	11985
2013-12-01T00:00:00.000Z	315	12300
2013-12-01T00:00:00.000Z	0	12300
2013-12-01T00:00:00.000Z	516	12816
2013-12-01T00:00:00.000Z	0	12816
2013-12-01T00:00:00.000Z	1051	13867
2013-12-01T00:00:00.000Z	533	14400
2013-12-01T00:00:00.000Z	20	14420
2013-12-01T00:00:00.000Z	489	14909
2013-12-01T00:00:00.000Z	506	15415
2013-12-01T00:00:00.000Z	491	15906
2013-12-01T00:00:00.000Z	0	15906
2013-12-01T00:00:00.000Z	493	16399
2013-12-01T00:00:00.000Z	63	16462
2013-12-01T00:00:00.000Z	380	16842
2013-12-01T00:00:00.000Z	339	17181
2013-12-01T00:00:00.000Z	151	17332
2013-12-01T00:00:00.000Z	300	17632
2013-12-01T00:00:00.000Z	68	17700
2013-12-01T00:00:00.000Z	107	17807
2013-12-01T00:00:00.000Z	501	18308
2013-12-01T00:00:00.000Z	34	18342
2013-12-01T00:00:00.000Z	286	18628
2013-12-01T00:00:00.000Z	504	19132
2013-12-01T00:00:00.000Z	69	19201
2013-12-01T00:00:00.000Z	290	19491
2013-12-01T00:00:00.000Z	497	19988
2013-12-01T00:00:00.000Z	0	19988
2013-12-01T00:00:00.000Z	67	20055
2013-12-01T00:00:00.000Z	305	20360
2013-12-01T00:00:00.000Z	289	20649
2013-12-01T00:00:00.000Z	0	20649
2013-12-01T00:00:00.000Z	481	21130
2013-12-01T00:00:00.000Z	6	21136
2013-12-01T00:00:00.000Z	278	21414
2013-12-01T00:00:00.000Z	30	21444
2013-12-01T00:00:00.000Z	142	21586
2013-12-01T00:00:00.000Z	58	21644
2013-12-01T00:00:00.000Z	304	21948
2013-12-01T00:00:00.000Z	508	22456
2013-12-01T00:00:00.000Z	110	22566
2013-12-01T00:00:00.000Z	92	22658
2013-12-01T00:00:00.000Z	317	22975
2013-12-01T00:00:00.000Z	84	23059
2013-12-01T00:00:00.000Z	297	23356
2013-12-01T00:00:00.000Z	57	23413
2013-12-01T00:00:00.000Z	0	23413
2013-12-01T00:00:00.000Z	353	23766
2013-12-01T00:00:00.000Z	498	24264
2013-12-01T00:00:00.000Z	0	24264
2013-12-01T00:00:00.000Z	304	24568
2013-12-01T00:00:00.000Z	51	24619
2013-12-01T00:00:00.000Z	287	24906
2013-12-01T00:00:00.000Z	41	24947
2013-12-01T00:00:00.000Z	498	25445
2013-12-01T00:00:00.000Z	150	25595
2013-12-01T00:00:00.000Z	10	25605
2013-12-01T00:00:00.000Z	266	25871
2013-12-01T00:00:00.000Z	79	25950
2013-12-01T00:00:00.000Z	119	26069
2013-12-01T00:00:00.000Z	485	26554
2014-01-01T00:00:00.000Z	515	515
2014-01-01T00:00:00.000Z	0	515
2014-01-01T00:00:00.000Z	37	552
2014-01-01T00:00:00.000Z	273	825
2014-01-01T00:00:00.000Z	491	1316
2014-01-01T00:00:00.000Z	693	2009
*/
