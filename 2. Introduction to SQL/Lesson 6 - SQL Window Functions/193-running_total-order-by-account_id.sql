/*
Programming for Data Science with Python Nanodegree
Udacity's certified program > SQL practice > Lesson 6 : SQL Window Functions

WINDOW FUNCTIONS:

Running total of standard_qty by account_id
*/

SELECT account_id,
       occurred_at,
       standard_qty,
       SUM(standard_qty) OVER (ORDER BY account_id) AS running_total
FROM orders;

/*
Output6912 results
account_id	occurred_at	standard_qty	running_total
1001	2016-10-26T20:31:30.000Z	97	7896
1001	2016-11-25T23:19:37.000Z	485	7896
1001	2016-09-26T23:22:47.000Z	507	7896
1001	2016-08-28T06:50:58.000Z	557	7896
1001	2016-07-30T03:21:57.000Z	457	7896
1001	2016-05-31T21:09:48.000Z	531	7896
1001	2016-05-01T15:40:04.000Z	483	7896
1001	2016-04-01T11:15:27.000Z	497	7896
1001	2016-03-02T15:40:29.000Z	498	7896
1001	2016-02-01T19:07:32.000Z	473	7896
1001	2016-01-02T00:59:09.000Z	566	7896
1001	2016-07-30T03:26:30.000Z	101	7896
1001	2016-08-28T07:13:39.000Z	124	7896
1001	2016-09-26T23:28:25.000Z	104	7896
1001	2015-10-06T17:31:14.000Z	123	7896
1001	2016-01-02T01:18:24.000Z	144	7896
1001	2015-12-04T04:21:55.000Z	85	7896
1001	2015-11-05T03:34:33.000Z	190	7896
1001	2016-12-24T05:53:13.000Z	123	7896
1001	2016-11-25T23:21:32.000Z	127	7896
1001	2016-02-01T19:27:27.000Z	108	7896
1001	2016-03-02T15:29:32.000Z	103	7896
1001	2016-04-01T11:20:18.000Z	101	7896
1001	2016-05-01T15:55:51.000Z	95	7896
1001	2016-05-31T21:22:48.000Z	91	7896
1001	2016-06-30T12:32:05.000Z	94	7896
1001	2015-12-04T04:01:09.000Z	526	7896
1001	2015-11-05T03:25:21.000Z	506	7896
1011	2016-12-21T10:59:34.000Z	527	8423
1021	2015-10-12T02:31:30.000Z	0	11575
1021	2015-12-11T16:53:18.000Z	483	11575
1021	2015-11-11T07:37:01.000Z	497	11575

and remaining rows
*/
